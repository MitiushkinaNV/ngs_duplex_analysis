This repository contains custom python scripts created for the analysis of NGS libraries prepared with BotSeqS method (Hoang M. et al., 2016; doi: 10.1073/pnas.1607794113) and sequenced on Illumina platform in paired-end mode. The bioinformatic pipeline used here was developed to analyze data obtained without parallel analysis of the whole genome to exclude all germline variants. Instead, only known polymorphisms with the specified population frequencies are removed from the resulting list of somatic mutations. Most of the scripts require pysam package (https://github.com/pysam-developers/pysam) to be installed.

find_overcovered_regions.py is simply find regions, which are covered in preselected number (or more) of the studied samples. These regions will then be removed from analysis. Arguments:
	"-f","--file_in" The input file with depths of coverage in all samples in all covered regions. It is supposed to be created with SAMtools depth command. (Required argument) 
	"-o","--file_out" The output file name. (Default: "overcovered.txt")
	"-n","--num_samples" The minimun number of samples in which the region has to be covered. (Required argument) 

filter_and_merge_reads.py Filters reads with MQ<60, reads with soft-clipped bases, improper read pairs and reads that fall into one of the previously found overcovered regions. The remaining reads R1 and R2 from each pair are joined together.
	"-f","--file_in" Input BAM file with all aligned reads for one sample, sorted by query name. (Required argument)
	"-o","--file_out" Name for the output BAM file. (Required argument)
	"-c","--overcovered_regions" File with specified overcovered regions.

find_duplexes.py Finds the coordinates of potential duplexes and writes the respective reads into one of the two separate files depending on what read (R1 or R2) in the read pair has the smallest genomic coordinate. It also outputs additional data for statistical analysis in a separate file.
	"-f","--file_in" Input file name. File created by filter_and_merge_reads.py and sorted by coordinate is required. (Required argument)  
	"-o","--file_out_prefix" The prefix, which will be used for the output "R1" and "R2" sam files and the file with the positions of all duplexes (usually, the sample label). (Required argument)
	"-n","--read_num" Min number of duplicates required to build a single-strand consensus sequence. (Default value: 5)
	"-l","--length_precision" The maximum difference between the lengths of template sequences within a duplex, which will be tolerated (+/- value, base pairs). (Default value: 2)

process_duplexes.py Analyzes duplexes found by the find_duplexes.py script. 
	"-f1","--file_in_r1" and "-f2","--file_in_r2" Required input files in BAM format. SAM files generated by the find_duplexes.py script must converted to the BAM format and sorted by coordinate.
	"-d","--dup_positions" File with the genomic coordinates of the duplexes, generated by the find_duplexes.py script (Required argument)
	"-r","--reference_file" Reference fasta file used in read alignment (Required argument)
	"-v","--vcf_file" File with the SNP population frequencies (e.g. gnomAD), in VCF format (Required argument)
	"-af","--max_af" Polymorphisms with this or higher population frequency will be excluded. (Default value: 0.01)
	"-l","--sample_label" Label for the analyzed sample to use in the output files (Required argument)
	"-c","--chr_dict" Text file with chromosomes, which are to be included in analysis, with their respective aliases in BAM and VCF files. The example of such file (chromosome_dictionary.txt) is provided in the repository. (Required argument)
	"-cn","--cycle_number" Number of cycles used per single read in paired-end sequencing. (Required argument)
	"-n","--read_num" Minimal number of duplicates required to build a single-strand consensus sequence. (Default value: 5)
	"-f","--fraction" Minimal fraction of reads with the same nucleotide required to include this nucleotide in a consensus sequence. (Default value: 0.8)
	"-s","--skip_from_end" Number of nucleotides to skip from eigher end of the read. (Default value: 5)
	"-p","--position_statistics_file" Name for the output file, to which main analysis results will be written (Default value: "position_statistics.txt")
	"-m","--mutation_limit" Reads with this or higher number of mutations will be exluded (Default value: 3)

